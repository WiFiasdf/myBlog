# 前言

Windows 系统作为最常见的操作系统之一，其稳定性直接关系到用户的日常工作和生活体验。然而，系统崩溃、文件损坏、驱动冲突等问题时有发生。

本系列文章将会把软件层面的问题细分成若干个大类，本文将会侧重于 **Windows 系统本身的故障**，而非驱动、应用程序之类的故障。本文将结合 Windows 内置工具和实用第三方工具，并用几个典型问题来讲解。

> **提示**：文中提到的工具请读者自行准备，都是可以在必应上搜索得到的。

---

# 评估

根据第一章中介绍的"望闻问切"理论，需要对问题进行评估。通常需要对**时间成本**和**恢复能力**进行评估，然后进行抉择并告知求助者。

比如在经过简单排查后，认为为了保护资料，需要花费很多时间去细致修复系统；又或是不需要保护资料，直接重装系统也可。

> **重要提醒**：如果你不知道你的操作是在干什么，或者不能预见此操作可能带来的后果，那就请不要操作。**数据无价**，请务必谨慎操作。

---

# 典型故障排查与解决

## 典例一：引导分区故障

### 故障原因

可能是在对硬盘分区进行操作时，错误地更改了系统引导分区，常见于 UEFI 引导的系统上。

> **名词解释**：
> - **UEFI（Unified Extensible Firmware Interface）**：统一可扩展固件接口，是新一代的系统固件接口标准，用于替代传统的 BIOS。它提供更快的启动速度、更大的磁盘支持（超过2TB）和更安全的安全启动功能。
> - **EFI 分区**：EFI 系统分区，用于存储 UEFI 引导所需的启动文件，通常为 FAT32 格式。

### 修复方法

推荐大家使用 **EasyUEFI** 或者 **傲梅分区助手**来进行修复。亲测在 PE 系统下也可以这样操作。这里以 EasyUEFI 为例来做演示。

1. 打开 EasyUEFI，进入 EFI 分区管理

![image-20250715160916722](./3%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BF%AE%E5%A4%8D.assets/image-20250715160916722.png)

2. 选择重建 EFI 分区

![image-20250715160956198](./3%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BF%AE%E5%A4%8D.assets/image-20250715160956198.png)

3. 选择要操作的硬盘，然后分别选择需要引导的系统分区和 EFI 引导分区

![image-20250715161155307](./3%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BF%AE%E5%A4%8D.assets/image-20250715161155307.png)

最后点击"确定"即可完成对引导分区的修复。

---

## 典例二：系统组件损坏

一般的系统组件损坏（比如任务栏突然消失，或者打开某个组件报错之类的）还不至于重装系统，通常用系统自带的工具进行修复足矣。如果情况确实比较严重，或者经沟通后可以重装系统再进行重装。

### 方法一：使用系统自带命令修复

以下命令参考自微软官方手册，更多高级操作和讲解请自行查阅[官方手册1](https://learn.microsoft.com/zh-cn/troubleshoot/windows-server/installing-updates-features-roles/fix-windows-update-errors)和[官方手册2](https://support.microsoft.com/zh-cn/topic/使用系统文件检查器工具修复丢失或损坏的系统文件-79aa86cb-ca52-166a-92a3-966e85d4094e)。

1. 右键任务栏的 Windows 图标，然后选择"终端（管理员）"
2. 确保 Windows 处于联网状态。输入以下命令后按 Enter：`DISM.exe /Online /Cleanup-image /Restorehealth`
   - 此命令可能会花费一点时间，请耐心等待，切勿中断。
3. 输入 `sfc /scannow` 命令，然后按 Enter
   - 此命令可能会花费一点时间，请耐心等待，切勿中断。
4. 重启电脑，检查修复效果。

> **名词解释**：
> - **DISM**：部署映像服务和管理工具（Deployment Image Servicing and Management），用于修复 Windows 映像中的各种问题。
> - **SFC**：系统文件检查器（System File Checker），用于扫描并修复 Windows 系统文件的完整性。

### 方法二：覆盖升级安装

如果上述两条命令无法修复系统，我们还可以考虑去官网或者 MSDN 下载官方原版 Windows 镜像文件，然后覆盖升级安装。

1. 双击打开 ISO 文件（不用解压，右键用文件资源管理器打开），然后双击打开图中的可执行文件

![image-20250715165653482](./3%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BF%AE%E5%A4%8D.assets/image-20250715165653482.png)

2. 一路默认来到这个界面，默认会保留文件和应用，你也可以手动更改要保留的内容。然后点击"安装"即可。等待覆盖升级安装完成，期间会自动重启。确保电脑插着电源线。

![image-20250715171320583](./3%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BF%AE%E5%A4%8D.assets/image-20250715171320583.png)

> **名词解释**：
> - **ISO 文件**：一种光盘镜像文件格式，包含了完整的光盘数据，可直接挂载使用或刻录到光盘/U盘中。

---

## 典例三：卸载 Windows 更新

如果出现安装完 Windows 更新后，系统出现一些 bug，影响了正常使用，可以卸载掉安装的更新。微软官方提供了简明的教程：[如何卸载 Windows 更新 - Microsoft 支持](https://support.microsoft.com/zh-cn/windows/如何卸载windows-更新-c77b8f9b-e4dc-4e9f-a803-fdec12e59fb0#id0ebbf=windows_11)

---

## 典例四：Windows 更新出错

幸运的是微软官方也提供了完整、权威的教程：[解决更新 Windows 时遇到的问题 - Microsoft 支持](https://support.microsoft.com/zh-cn/windows/解决更新-windows-时遇到的问题-188c2b0f-10a7-d72f-65b8-32d177eb136c#id0ebbf=windows_10)

这里需要说明的是，官方教程中将修复系统组件的操作放在了末尾处，其实依笔者个人经验来看，在初步排查处理过问题后仍无效果，就可以直接尝试修复系统组件了。另外如果是下载更新出错，可以去必应搜索一下更新编号，然后手动下载更新包。

---

## ★ 典例五：重装系统

> **注意**：这里仅讲解如何安装系统，初始系统的配置优化操作将在后续章节中讲到。现在网络上有很多重装系统的文章和视频，方法都大同小异，主要适用于普通用户使用。笔者自己摸索出来一种比较稳妥和实用的安装方式，主要适用于维修者使用。

重装系统往往是处理软件层面问题的最终手段，**不到万不得已切勿使用**。因为备份文件和安装原来软件的时间成本和精力成本都是很大的。这里我们将用到 EasyU（优启通）以及 Windows 10 官方镜像。

**下载链接**：
- [优启通 v3.7.2025.0326](https://www.itsk.com/thread/434043)
- [下载 Windows 10](https://www.microsoft.com/zh-cn/software-download/windows10)
- [MSDN](https://next.itellyou.cn/Original/Index)

### 1. 制作 PE 盘

经过多次测试和经验总结，得出以下结论（仅供参考，具体以实际情况为准）：

| PE 工具 | 特点 |
| --- | --- |
| **FirPE** | 功能强大，高自定义，对老机型兼容性欠佳，界面美观，无捆绑 |
| **冰封PE** | 对于 Secure Boot 支持不好，有些电脑需要进 BIOS 关闭 Secure Boot |
| **微PE** | 版本多，区分 32 位和 64 位，极简风，对新硬件兼容不好，对 Secure Boot 支持不好，无捆绑 |
| **优启通** | 功能强大，兼容性好 |
| **U盘魔术师 USMv6** | 功能最为强大，兼容性最好，支持 VM 虚拟机，支持大部分触摸板，体积庞大，自带的系统安装器有广告捆绑 |

> **名词解释**：
> - **PE（Preinstallation Environment）**：预安装环境，是一个精简版的操作系统，常用于系统安装、维护和修复。PE 系统通常从 U 盘启动，可以在不依赖原系统的情况下进行各种操作。
> - **Secure Boot**：安全启动，是 UEFI 的一项安全功能，用于防止未经授权的固件、操作系统或引导加载程序在启动时运行。

我个人更推荐使用优启通，当然也要备好微 PE 和 USMv6，以防遇到特殊不兼容情况。这里我们将用到 EasyU（优启通）。

> **温馨提示**：
> - 制作前把 U 盘腾空，因为 PE 制作工具会对你的 U 盘进行重新分区，会进行格式化，**U 盘里面的数据会丢失**。
> - 关闭杀毒软件，因为制作 PE 盘会涉及系统敏感文件的操作，有些杀毒软件可能会误杀，所以请关闭杀毒软件。

插入 U 盘，如图所示点击"全新制作"即可将 PE 写入 U 盘：

![image-20241028135631230](./3%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BF%AE%E5%A4%8D.assets/image-20241028135631230.png)

### 2. 进入 PE 系统

**（1）在 U 盘插入电脑的情况下开机，然后立即多次点按对应的快捷键。** 下图快捷键仅供参考，视具体情况而定：

![image-20250715190752346](./3%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BF%AE%E5%A4%8D.assets/image-20250715190752346.png)

**（2）选择 U 盘启动项，然后回车。** 注意：通常有"USB"字样，有些是 U 盘品牌名字：

![image-20250715190814182](./3%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BF%AE%E5%A4%8D.assets/image-20250715190814182.png)

**（3）上下两个选项似乎没什么大的区别，直接按回车即可：**

![image-20250715190839014](./3%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BF%AE%E5%A4%8D.assets/image-20250715190839014.png)

**（4）再等一会，就能见到 PE 系统桌面了。** 进入桌面后还要等待一些模块加载，桌面图标都出来后就正常了。

### 处理 Secure Boot 问题

由于不同厂家的 BIOS 界面有所不同，这里只说一下通用的思路。请注意：如果你进入选择启动项界面后，选中了 PE 盘，按了回车键后，系统提示有"Secure Boot"的字样再进行下面的操作。如果没有请忽视本段内容即可。

另外操作完一切后再开启 Secure Boot，因为这不符合 Windows 11 的要求，更新系统可能会有未知的问题。

**（1）进入电脑 BIOS**

通过键盘和回车键（如果支持鼠标就用鼠标）找到"Secure Boot"或"安全启动"字样，将"Enabled（启用）"字样切换为"Disabled（禁用）"字样。

**（2）然后按 F10 即可。**

开启 Secure Boot 同理，这里就不过多赘述了。

> **名词解释**：
> - **BIOS（Basic Input/Output System）**：基本输入输出系统，是电脑启动时运行的第一个软件，负责初始化硬件并加载操作系统。现代电脑通常使用 UEFI 替代传统的 BIOS。

### 3. 删除系统相关分区

> **特别说明 1**：操作这一步的原因是当进入 Windows 安装界面后分区都是编号，不易于区分了，有多个分区和硬盘时这会很麻烦，所以我们事先在易于辨认分区的软件中删除要安装系统的分区。另外创建分区也是同理，选中未分配的分区然后点击新建分区即可。

> **特别说明 2**：在删除系统相关分区前可以在 PE 系统中对 C 盘的重要文件进行备份，建议备份到 U 盘或者其它硬盘中。

**（1）打开 DiskGenius，确认需要删除的分区，如下图所示：**

![image-20250715203148164](./3%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BF%AE%E5%A4%8D.assets/image-20250715203148164.png)

- 1、2 号分区为 ESP 和 MSR 分区，前者用来存储 UEFI 引导所需文件，后者是保留空间，选中后删除即可，在安装系统阶段会自动创建。
- 3 号分区为系统分区，选中后删除即可。
- 4 号为 WinRE 分区，选中后删除即可，在安装系统阶段会自动创建。

> **名词解释**：
> - **MSR 分区**：微软保留分区，用于存储磁盘元数据，是 UEFI 系统的标准分区类型之一。
> - **WinRE 分区**：Windows 恢复环境分区，用于存储系统恢复工具，可以在系统出现问题时进行修复或恢复。

**若出现下图中的分区样式需要仔细辨别：**

![image-20250715204058693](./3%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BF%AE%E5%A4%8D.assets/image-20250715204058693.png)

- 1、2 号分区为 ESP 和 MSR 分区
- 3 号分区为系统分区
- 4 号分区为 D 盘，重装系统通常不需要动其它与系统无关的盘，不需要删除 4 号分区
- 5 号分区为 WinRE 分区
- 6、7 为 OEM 厂商创建的恢复和维护用的分区，不建议删除，否则很难恢复原厂系统

> **注意**：为什么不恢复原厂系统呢？因为恢复原厂系统通常会删除并重建其它所有分区，甚至可能包括自己后加的硬盘，从而丢失很多重要数据。所以并不建议直接恢复原厂系统。仅在确有必要时再恢复。

ESP 和 MSR 分区易于从分区名称识别，WinRE 分区最好的识别方式是去浏览分区文件，若分区中有 WindowsRE 字样就是 WinRE 分区，如下图所示：

![image-20250715204745002](./3%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BF%AE%E5%A4%8D.assets/image-20250715204745002.png)

好了，上面已经讲了很多注意事项了，删除完所有分区后记得点左上角的"保存更改"，否则更改将无法生效。

### 4. 进入正式安装阶段

双击打开需要安装的系统 ISO 文件，双击运行如图所示的 exe 可执行程序：

![image-20250715205103657](./3%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BF%AE%E5%A4%8D.assets/image-20250715205103657.png)

一路默认来到这个界面，选择"我没有产品密钥"：

![image-20250715205254703](./3%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BF%AE%E5%A4%8D.assets/image-20250715205254703.png)

然后在这个界面选择要安装的版本，一般建议选择专业版或者专业工作站版即可：

![image-20250715205404565](./3%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BF%AE%E5%A4%8D.assets/image-20250715205404565.png)

点击接受许可协议：

![image-20250715205448146](./3%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BF%AE%E5%A4%8D.assets/image-20250715205448146.png)

选择第二个"自定义安装 Windows"：

![image-20250715205510058](./3%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BF%AE%E5%A4%8D.assets/image-20250715205510058.png)

然后来到了分区界面：

![image-20250715205614538](./3%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BF%AE%E5%A4%8D.assets/image-20250715205614538.png)

这里我们可以看到，硬盘以编号形式出现，所以如果有多个硬盘或者分区将不好区分。而当我们删除了需要操作的分区后，这个界面就会显示出一个空间较大的未分配空间，这样就很好辨认了。体会到上述删除分区的作用了吗？不过如果你能轻松根据每个分区的大小就辨别出各个分区谁是谁的话，那当我没说。

选中这个较大的未分配空间，然后点击下方的"新建"，再点击"应用"，这里会有一个弹窗，意思就是要创建刚刚我们删除掉的 ESP、MSR 那些分区，点击"确定"即可创建完成。

![image-20250715210230109](./3%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BF%AE%E5%A4%8D.assets/image-20250715210230109.png)

再点击下一步，就可以去喝杯茶或者咖啡坐下休息一下了，直到电脑重启完成。

### 5. 根据 OOBE 进行设置

> **名词解释**：
> - **OOBE（Out-of-Box Experience）**：开箱体验，指用户首次启动新安装的 Windows 系统时经历的一系列初始化设置步骤。

需要说明的是，**能不联网就不联网（Win11 需要命令行跳过联网）**，微软账号可以稍后再登录，**另外用户名尽量使用英文的**，点击左下角"我没有网络连接"，然后点击"继续进行有限设置"：

![image-20250715211627463](./3%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BF%AE%E5%A4%8D.assets/image-20250715211627463.png)

![image-20250715211726369](./3%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BF%AE%E5%A4%8D.assets/image-20250715211726369.png)

在这个界面中建议把所有选项都关闭：

![image-20250715211821886](./3%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BF%AE%E5%A4%8D.assets/image-20250715211821886.png)

然后点击"接受"，等待片刻后即可进入系统。

### 6. 安装驱动

进入系统后，或许你会发现还有一些问题，比如无法调节屏幕亮度，显示缩放比例不正常。Windows 会自带一些通用驱动，但是通用的肯定比不上专用的驱动好。这时就需要我们去电脑官网上下载驱动了，当然如果图省事儿也可以下载 360 驱动或者驱动总裁来快捷安装驱动。

具体操作细节笔者会在后续章节中详细讲解。

### 7. 激活系统

未激活的系统右下角会有水印，并且无法进行个性化设置。如果你能接受，可以不管。这里推荐使用 [HEU_KMS_Activator](https://github.com/zbezj/HEU_KMS_Activator/releases) 来进行激活。

具体操作读者可自行必应搜索一下，还是比较简单的。

### 8. 安装 Windows 11 系统注意事项

Windows 11 系统与前几代系统最显著的区别就是会强制联网登录与更新以及自动加密硬盘。这些都是非常烦人的东西，需要一些特殊手段来处理应对。

#### 1）跳过强制联网登录与更新

**方法一：**

- 开机后，根据引导来到联网页面，然后停下，不要联网
- 同时按下键盘上的 `Shift+F10` 或者 `Fn+Shift+F10`
- 点击一下黑色命令行窗口，输入 `oobe\bypassnro`，按下回车等待重启
- 继续根据引导来到联网界面，选择"我没有 Internet 连接"，点击"继续执行受限设置"，然后根据引导继续

> **注**：建议用户名使用全英文，避免软件兼容性问题。

**方法二：**

- 来到登录微软账号界面然后停下
- 然后一直随便乱输入邮箱和密码，直到系统愿意让你创建本地账户

> **注**：建议用户名使用全英文，避免软件兼容性问题。

**方法三：**

- 开机后，根据引导来到联网页面，然后停下，不要联网
- 同时按下键盘上的 `Shift+F10` 或者 `Fn+Shift+F10`
- 点击一下黑色命令行窗口，输入 `start ms-cxh:localonly` 然后回车，根据提示创建本地账户即可

#### 2）关闭 Windows 11 的自动硬盘加密

原版的 Windows 11 系统都会默认加密硬盘，包括 OEM 厂商们。硬盘加密与否各有优缺点。

| 加密状态 | 优点 | 缺点 |
| --- | --- | --- |
| **已加密** | 数据非常安全，即使硬盘被拆下插在别的电脑上读取也不会数据泄密 | 当系统损坏时，需要在 PE 系统中导资料时将非常困难（甚至无法完成） |
| **未加密** | 硬盘间传输性能理论上会略微高一点点（几乎无感），系统损坏时导资料会变得畅通无阻 | 数据安全性相对较低 |

关闭硬盘加密也很简单，在系统设置中找到下图所示的开关关掉即可：

![image-20250916092542383](./3%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BF%AE%E5%A4%8D.assets/image-20250916092542383.png)

---

## 典例六：处理 C 盘爆满

此问题将在后续有关系统优化的章节中详细讲解。

---

## 典例七：处理卡死的应用程序

在使用应用程序的过程中往往遇到过卡死的情况，如果是系统卡死了，直接重启大概率都能解决。如果只是应用程序卡死了，可以不用重启也能恢复正常使用。

**操作步骤：**

1. 在任务栏处右键，或者按 `Ctrl+Alt+Delete` 快捷键，然后点击"任务管理器"
2. 点击"详细信息"，然后在列表中选中卡死的应用程序
3. 点击右下角的"结束任务"即可

![image-20250916093638066](./3%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BF%AE%E5%A4%8D.assets/image-20250916093638066.png)

---

# 关于 Windows 更新一些想说的

近几年来 Windows 的更新一直被人们诟病，各个平台都有相关的视频或者文章在说这个事儿。我这里发表一下我个人的看法，我并不认为 Windows 的更新有多大的罪孽。

首先，自 2018 年至 2024 年间我使用的是 Windows 10 系统，期间有穿插几个月在使用 Linux 系统。我的习惯比较激进，都是能更新都更新（可能是使用 openSUSE Tumbleweed 的习惯，每天必检查更新一次 😄）。但是在这么长的一段时间里完全没有遇到纯粹因为 Windows 更新而造成的性能问题和功能性 bug（或许是我运气好？），期间几次的重装系统也是因为我作死乱搞造成的。

从我个人的角度来说，我认为网上很多人诟病 Windows 更新一方面是因为出问题了才发出来，没出问题的继续用着；另一方面是因为使用者的一些风险操作刚好在系统更新之后，从而造成误以为是 Windows 更新的锅。

实际上，就算 Windows 更新确实被证实确有问题，微软也会紧急撤回更新的发布，后续会发布相关修复补丁以解决。Windows 更新既是微软对系统漏洞修复，也是改善对硬件设备支持的重要途径，系统的更新是必要的。

综上，Windows 更新并没有网上传播的那么恐怖，但是也不建议大家第一时间更新系统，要**缓更、慢更、辩证地更**，通常一个月更新一次就足够了。如果实在担心，可以搜索一下更新包的编号，看看有没有被证实的 bug。

---

# 结语

希望本文能为遇到 Windows 系统问题的读者提供清晰的指导思路和实用的解决方案。在后续章节中，我们将继续深入探讨系统优化、驱动安装、配置调整等进阶内容，帮助大家更好地维护和提升 Windows 系统的稳定性和性能。
